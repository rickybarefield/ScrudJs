// Generated by CoffeeScript 1.3.3
(function() {
  var WebSocket, WebSocketClient,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  WebSocketClient = require('websocket').client;

  WebSocket = (function() {

    function WebSocket(uri) {
      this.send = __bind(this.send, this);

      var doOpen, self,
        _this = this;
      self = this;
      this.socket = new WebSocketClient();
      doOpen = function(connection) {
        if ((self.onopen != null)) {
          self.onopen.call(arguments);
        } else {
          console.log("onopen was not defined so could not be called");
        }
        return self.connection = connection;
      };
      this.socket.on('connect', function() {
        return doOpen.apply(_this, arguments);
      });
      this.socket.on('message', function() {
        if ((_this.onmessage != null)) {
          return _this.onmessage.call(arguments);
        } else {
          return console.log("onmessage was not defined so could not be called");
        }
      });
      this.socket.on('close', function() {
        if ((_this.onclose != null)) {
          return _this.onclose.call(arguments);
        } else {
          return console.log("onclose was not defined so could not be called");
        }
      });
      this.socket.connect(uri);
    }

    WebSocket.prototype.send = function(message) {
      return this.connection.sendUTF(message);
    };

    return WebSocket;

  })();

  global.WebSocket = WebSocket;

}).call(this);
