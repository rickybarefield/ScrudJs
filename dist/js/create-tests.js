// Generated by CoffeeScript 1.4.0
(function() {
  var MockWebSocket, Scrud, assert, expect, mockWebSocket, scrudConnection, sinon;

  expect = require("./expect.js");

  sinon = require("sinon");

  Scrud = require("./Scrud.js");

  MockWebSocket = require("./MockWebSocket.js");

  assert = new expect.Assertion;

  scrudConnection = new Scrud("http://localhost:8080/websocket");

  scrudConnection.connect();

  mockWebSocket = MockWebSocket.lastCreated;

  suite('Create', function() {});

  test('correct JSON is produced', function() {
    var clientId, createMessage, jsonSent, resource, type;
    clientId = "myClientId";
    type = "Item";
    resource = {
      name: 'MyItem'
    };
    createMessage = new scrudConnection.Create(clientId, type, resource, function() {
      var success;
      return success = true;
    });
    createMessage.send();
    jsonSent = mockWebSocket.lastMessageSent;
    return expect(jsonSent).to.equal('{"client-id":"myClientId","type":"Item","resource":{"name":"MyItem"}}');
  });

  test('onSuccess function should be called', function() {
    var clientId, createMessage, resource, success, type;
    clientId = "myClientId";
    type = "Item";
    resource = {
      name: 'MyItem'
    };
    success = false;
    createMessage = new scrudConnection.Create(clientId, type, resource, function() {
      return success = true;
    });
    return expect(success).to.equal(true);
  });

}).call(this);
